import bpy
D=bpy.data

global idx
idx=0

def process_mat_multi(mat_name):
    global idx
    matnode=tree.nodes['Principled BSDF']
    if not (matnode.inputs[mat_name].is_linked):
        color = matnode.inputs[mat_name].default_value
        imagename="{0}".format(idx)
        imagename=D.images.new(imagename,16,16).name
        
        for x in range(0,1024,4):
            D.images[imagename].pixels[x]=  pow(color[0],1/2.2)
            D.images[imagename].pixels[x+1]=pow(color[1],1/2.2)
            D.images[imagename].pixels[x+2]=pow(color[2],1/2.2)
            D.images[imagename].pixels[x+3]=1.0
        #D.images[imagename].colorspace_settings.name='sRGB'
            
        node=tree.nodes.new('ShaderNodeTexImage')
        node.image=D.images[imagename]
        tree.links.new(node.outputs['Color'],matnode.inputs[mat_name])
        
        idx=idx+1

def process_mat_single(mat_name):
    global idx
    matnode=tree.nodes['Principled BSDF']
    if not (matnode.inputs[mat_name].is_linked):
        color = matnode.inputs[mat_name].default_value
        imagename="{0}".format(idx)
        imagename=D.images.new(imagename,16,16).name
        
        for x in range(0,1024,4):
            D.images[imagename].pixels[x]=color
            D.images[imagename].pixels[x+1]=color
            D.images[imagename].pixels[x+2]=color
            D.images[imagename].pixels[x+3]=1.0
            
            
        node=tree.nodes.new('ShaderNodeTexImage')
        node.image=D.images[imagename]
        tree.links.new(node.outputs['Color'],matnode.inputs[mat_name])
        
        idx=idx+1
        
for mat in D.materials:
    tree=mat.node_tree
    print(mat.name)
    if tree is not None:
        process_mat_multi('Emission')       
        process_mat_multi('Base Color')
        process_mat_single('Roughness')
        process_mat_single('Metallic')